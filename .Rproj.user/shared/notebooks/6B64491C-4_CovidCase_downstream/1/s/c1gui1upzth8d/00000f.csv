"0","stageR_res <- vector(mode=""list"",length = 5)"
"0","names(stageR_res) <- names(DD_res)"
"0",""
"0","for (j in seq_along(DD_res)) {"
"0","  stageR_res_j <- vector(mode=""list"",length = 5)"
"0","  names(stageR_res_j) <- levels(pb_bin_ct$`B cell`$Status_on_day_collection_summary)[2:6]"
"0","  "
"0","  for(i in 1:5){"
"0","    pScreen <- rep(NA, nrow(DD_res[[j]][[i]]))"
"0","    for(h in 1:length(pScreen)){"
"0","        if(is.na(DD_res[[j]][[i]]$PValue[h])){"
"0","          pScreen[h] <- DGE_res[[j]][[i]]$PValue[h]"
"0","        } else {"
"0","          pScreen[h] <- hmp.stat(c(DD_res[[j]][[i]]$PValue[h],"
"0","                                   DGE_res[[j]][[i]]$PValue[h]),"
"0","                                 w=NULL)"
"0","        }"
"0","    }"
"0","    names(pScreen) <- rownames(DD_res[[j]][[i]])"
"0","    "
"0","    #confirmation stage"
"0","    pConfirmation <- as.matrix(cbind(DD_res[[j]][[i]]$PValue, DGE_res[[j]][[i]]$PValue))"
"0","    dimnames(pConfirmation) <- list(rownames(DD_res[[j]][[i]]), c(""DD"",""DE""))"
"0","    "
"0","    # stageWise analysis"
"0","    stageRObj <- stageR(pScreen=pScreen, "
"0","                        pConfirmation=pConfirmation, "
"0","                        pScreenAdjusted=FALSE)"
"0","    stageRObj <- stageWiseAdjustment(object=stageRObj, "
"0","                                     method=""none"", "
"0","                                     alpha=0.05,"
"0","                                     allowNA = TRUE)"
"0","    res <- getResults(stageRObj)"
"0","    print(colSums(res)) #stage-wise analysis results"
"0","    "
"0","    if(colSums(res)[1] == 1){"
"0","      DD_DE_Sig_j_i <- getAdjustedPValues(stageRObj, "
"0","                                      onlySignificantGenes=TRUE, "
"0","                                      order=FALSE)"
"0","    } else{"
"0","      DD_DE_Sig_j_i <- getAdjustedPValues(stageRObj, "
"0","                                      onlySignificantGenes=TRUE, "
"0","                                      order=TRUE)"
"0","    }"
"0","    "
"0","    if(is.null(DD_DE_Sig_j_i)){"
"0","      DD_DE_Sig_j_i <- NA"
"0","    }"
"0","    "
"0","    stageR_res_j[[i]] <- DD_DE_Sig_j_i"
"0","  }"
"0","  stageR_res[[j]] <- stageR_res_j"
"0","}"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         0 "
"1","         0 "
"1","         0 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         1 "
"1","         1 "
"1","         0 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         5 "
"1","         3 "
"1","         5 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         1 "
"1","         1 "
"1","         1 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         0 "
"1","         0 "
"1","         0 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         0 "
"1","         0 "
"1","         0 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","        95 "
"1","        33 "
"1","        81 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","       384 "
"1","       213 "
"1","       326 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","       180 "
"1","        72 "
"1","       138 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","        15 "
"1","        10 "
"1","         6 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         1 "
"1","         1 "
"1","         1 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","        71 "
"1","        40 "
"1","        55 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","       326 "
"1","       154 "
"1","       297 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","        88 "
"1","        52 "
"1","        74 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","        23 "
"1","        19 "
"1","         9 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         0 "
"1","         0 "
"1","         0 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","       266 "
"1","       161 "
"1","       229 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","      2345 "
"1","      1580 "
"1","      2239 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","      1529 "
"1","       812 "
"1","      1474 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","      1149 "
"1","       453 "
"1","      1125 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","         0 "
"1","         0 "
"1","         0 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","        36 "
"1","        21 "
"1","        21 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","       232 "
"1","       162 "
"1","       159 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","        99 "
"1","        30 "
"1","        84 "
"1","
"
"1","padjScreen "
"1","        DD "
"1","        DE "
"1","
"
"1","        16 "
"1","        14 "
"1","         3 "
"1","
"
