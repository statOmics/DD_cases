"0","label <- pb_bin$cell_type_curated"
"0","pb_bin_ct <- vector(mode =  ""list"", length = length(unique(label)))"
"0",""
"0","for (i in 1:length(unique(label))) {"
"0","  "
"0","  # currentlab <- as.character(sort(unique(label))[i])"
"0","  # # added line -> essential, as sample_ is only unique within cell type"
"0","  # pb_bin_hlp <- pb_bin[,pb_bin$cell_type_curated == currentlab]"
"0","  "
"0","  pb_bin_ct[[i]] <- pb_bin[rownames(pb_ct[[i]]),"
"0","                           match(pb_ct[[i]]$sample_id, pb_bin$sample_id)]"
"0","  colData(pb_bin_ct[[i]]) <- droplevels(colData(pb_bin_ct[[i]]))"
"0","}"
"0","names(pb_bin_ct) <- sort(unique(label))"
